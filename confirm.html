<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">

<title>内容確認｜合同会社 Lupin｜お問い合わせ入力内容の確認</title>
<meta name="description" content="合同会社Lupinのお問い合わせ内容確認ページ。入力いただいた情報の確認後、送信へお進みください。">

<link rel="stylesheet" href="css/style.css">

<!-- Lupin 統一デザイン（任意で強化可能） -->
<style>
/* ページ全体背景 */
body {
  background: #0F1E33;
  color: #FFFFFF;
}

/* 見出し */
h2 {
  font-size: 2rem;
  margin-bottom: 0.5em;
  color: #FFFFFF;
}
.midashi {
  font-size: 1.4rem;
  color: #FF7F32;
  margin-bottom: 1.5em;
}

/* Table */
.ta1 {
  width: 100%;
  margin-bottom: 2em;
  border-collapse: collapse;
}
.ta1 th {
  width: 25%;
  padding: 12px;
  background: #112240;
  border-bottom: 1px solid #555;
  text-align: left;
  color: #fff;
}
.ta1 td {
  padding: 12px;
  border-bottom: 1px solid #555;
  background: #0F1E33;
  color: #fff;
}

/* Buttons */
button {
  padding: 10px 20px;
  margin: 0 5px;
  background: #FF7F32;
  border: none;
  color: #fff;
  cursor: pointer;
  border-radius: 6px;
  font-size: 15px;
}
button:hover {
  background: #ffa766;
}
</style>

</head>

<body>

<div id="container">

<header>
<h1 id="logo"><a href="index.html">Lupin</a></h1>
<nav id="menubar">
<ul>
<li><a href="index.html">HOME</a></li>
<li><a href="service.html">SERVICE</a></li>
<li><a href="company.html">COMPANY</a></li>
<li><a href="message.html">MESSAGE</a></li>
<li><a href="form.html">CONTACT</a></li>
</ul>
</nav>
</header>

<div id="contents">
<main>

<section>
<h2>お問い合わせ内容の確認</h2>
<p class="midashi">入力内容をご確認ください</p>

<table class="ta1">
<tr>
<th>お名前</th>
<td id="c_name"></td>
</tr>

<tr>
<th>メールアドレス</th>
<td id="c_email"></td>
</tr>

<tr>
<th>お問い合わせ内容</th>
<td id="c_detail"></td>
</tr>
</table>

<p class="c">
<button id="sendBtn">送信する</button>
<button onclick="history.back();">戻る</button>
</p>

</section>

</main>
</div>

<footer>
<small>Copyright&copy; Lupin All Rights Reserved.</small>
</footer>

</div>

<script>
// ▼▼▼ GAS の URL（あなたの最新版） ▼▼▼
const GAS_URL =
"https://script.google.com/macros/s/AKfycbyV8PZiwOqyl9AFKqa0E2ZY5MJmetubM3UHtb5wmYmpRz96Jev-7-RNJ9Zkq8AkbRA2/exec";

// ---------- 1. sessionStorageから値を反映 ----------
document.getElementById("c_name").textContent =
  sessionStorage.getItem("item1") || "";
document.getElementById("c_email").textContent =
  sessionStorage.getItem("item2") || "";
document.getElementById("c_detail").textContent =
  sessionStorage.getItem("item3") || "";

// ---------- 2. GASへ送信 ----------
document.getElementById("sendBtn").addEventListener("click", function () {
  const data = {
    item1: sessionStorage.getItem("item1"),
    item2: sessionStorage.getItem("item2"),
    item3: sessionStorage.getItem("item3"),
  };

  fetch(GAS_URL, {
    method: "POST",
    body: JSON.stringify(data),
  })
    .then((res) => res.text())
    .then((txt) => {
      if (txt === "SUCCESS") {
        // 完了後データ削除
        sessionStorage.removeItem("item1");
        sessionStorage.removeItem("item2");
        sessionStorage.removeItem("item3");

        window.location.href = "finish.html";
      } else {
        alert("送信に失敗しました。");
        console.error("GAS response:", txt);
      }
    })
    .catch((err) => {
      alert("通信エラーが発生しました。");
      console.error(err);
    });
});
</script>

</body>
</html>
